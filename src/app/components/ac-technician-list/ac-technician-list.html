<!-- ac-technician-list.html -->
<div class="ac-technician-showcase" dir="rtl">
  <!-- Hero Header Section -->
  <section class="hero-header ac-hero">
    <div class="container">
      <div class="hero-content text-center">
        <div class="icon-wrapper animate-float">
          <div class="icon-circle">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
              <path d="M6.59 3.41L2 8L3.41 9.41L6.59 6.23C7.97 4.86 10.03 4 12 4C14.76 4 17.07 5.81 17.76 8.26L19.86 7.83C18.92 4.5 15.76 2 12 2C9.34 2 6.95 3.16 5.34 5.02L3.41 3.09L2 4.5L6.59 9.09L11.17 4.5L9.76 3.09L6.59 3.41ZM17.41 20.59L22 16L20.59 14.59L17.41 17.77C16.03 19.14 13.97 20 12 20C9.24 20 6.93 18.19 6.24 15.74L4.14 16.17C5.08 19.5 8.24 22 12 22C14.66 22 17.05 20.84 18.66 18.98L20.59 20.91L22 19.5L17.41 14.91L12.83 19.5L14.24 20.91L17.41 20.59Z" fill="currentColor"/>
            </svg>
          </div>
        </div>
        <h1 class="hero-title">فني تكييف - شحن وصيانة</h1>
        <p class="hero-subtitle">اختر أفضل فني تكييف محترف لصيانة وتركيب المكيفات</p>
        
        <!-- Stats Bar -->
        <div class="stats-bar">
          <div class="stat-item">
            <span class="stat-value">{{ acTechnicians().length }}</span>
            <span class="stat-label">فني تكييف</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-value">{{ verifiedTechnicians().length }}</span>
            <span class="stat-label">موثق</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-value">{{ emergencyTechnicians().length }}</span>
            <span class="stat-label">طوارئ 24/7</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="container main-content">
    <!-- Loading State -->
    @if (loading()) {
      <div class="loading-state">
        <div class="spinner-wrapper">
          <div class="custom-spinner">
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" class="spinner-icon">
              <path d="M6.59 3.41L2 8L3.41 9.41L6.59 6.23C7.97 4.86 10.03 4 12 4C14.76 4 17.07 5.81 17.76 8.26L19.86 7.83C18.92 4.5 15.76 2 12 2C9.34 2 6.95 3.16 5.34 5.02L3.41 3.09L2 4.5L6.59 9.09L11.17 4.5L9.76 3.09L6.59 3.41Z" fill="currentColor"/>
            </svg>
          </div>
          <p class="loading-text">جاري تحميل فنيي التكييف المحترفين...</p>
        </div>
      </div>
    }

    <!-- Error State -->
    @if (error()) {
      <div class="error-state">
        <div class="error-card">
          <div class="error-icon ac-error">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
              <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" fill="currentColor"/>
            </svg>
          </div>
          <h3 class="error-title">عذراً، حدث خطأ</h3>
          <p class="error-message">{{ error() }}</p>
          <button class="btn btn-retry ac-btn" (click)="loadAcTechnicians()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4C7.58 4 4.01 7.58 4.01 12C4.01 16.42 7.58 20 12 20C15.73 20 18.84 17.45 19.73 14H17.65C16.83 16.33 14.61 18 12 18C8.69 18 6 15.31 6 12C6 8.69 8.69 6 12 6C13.66 6 15.14 6.69 16.22 7.78L13 11H20V4L17.65 6.35Z" fill="currentColor"/>
            </svg>
            إعادة المحاولة
          </button>
        </div>
      </div>
    }

    <!-- Content -->
    @if (!loading() && !error()) {
      <!-- Search & Filter Bar -->
      <div class="search-filter-section">
        <div class="search-wrapper">
          <div class="search-box">
            <svg class="search-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" fill="currentColor"/>
            </svg>
            <input
              type="search"
              class="search-input"
              placeholder="ابحث عن فني تكييف بالاسم، المنطقة، الماركة أو الخدمة..."
              [value]="searchQuery()"
              (input)="onSearch($event)"
            />
            @if (searchQuery()) {
              <button class="clear-search" (click)="searchQuery.set('')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
                </svg>
              </button>
            }
          </div>
          
          <!-- Quick Filters -->
          <div class="quick-filters">
            <button 
              class="filter-chip" 
              [class.active]="isFilterActive('all')"
              (click)="showAll()"
            >
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M12 2L1 21H23L12 2Z" fill="currentColor"/>
              </svg>
              الكل
            </button>
            <button 
              class="filter-chip" 
              [class.active]="isFilterActive('verified')"
              (click)="filterVerified()"
            >
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor"/>
              </svg>
              موثق فقط
            </button>
            <button 
              class="filter-chip emergency-chip" 
              [class.active]="isFilterActive('emergency')"
              (click)="filterEmergency()"
            >
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M12 2L1 21H23L12 2ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z" fill="currentColor"/>
              </svg>
              طوارئ 24/7
            </button>
            <button 
              class="filter-chip" 
              [class.active]="isFilterActive('top-rated')"
              (click)="filterTopRated()"
            >
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z" fill="currentColor"/>
              </svg>
              الأعلى تقييماً
            </button>
          </div>
        </div>

        <!-- Results Count -->
        <div class="results-info">
          <p class="results-text">
            عرض <strong>{{ filteredAcTechnicians().length }}</strong> من <strong>{{ acTechnicians().length }}</strong> فني تكييف
          </p>
        </div>
      </div>

      <!-- AC Technicians Grid -->
      <div class="carpenters-grid">
        @for (technician of filteredAcTechnicians(); track trackByTechnicianId($index, technician); let idx = $index) {
          <div class="carpenter-card ac-card" [style.animation-delay]="idx * 0.1 + 's'">
            <!-- Card Header with Image -->
            <div class="card-header-image">
              @if (technician.imageUrl) {
                <img [src]="technician.imageUrl" [alt]="technician.name" class="carpenter-image" loading="lazy"/>
              } @else {
                <div class="placeholder-image ac-placeholder">
                  <div class="placeholder-pattern"></div>
                  <svg width="80" height="80" viewBox="0 0 24 24" fill="none">
                    <path d="M6.59 3.41L2 8L3.41 9.41L6.59 6.23C7.97 4.86 10.03 4 12 4C14.76 4 17.07 5.81 17.76 8.26L19.86 7.83C18.92 4.5 15.76 2 12 2C9.34 2 6.95 3.16 5.34 5.02L3.41 3.09L2 4.5L6.59 9.09L11.17 4.5L9.76 3.09L6.59 3.41Z" fill="currentColor" opacity="0.2"/>
                  </svg>
                </div>
              }
              
              <!-- Badges Overlay -->
              <div class="card-badges">
                @if (technician.isVerified) {
                  <span class="badge badge-verified">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor"/>
                    </svg>
                    موثق
                  </span>
                }
                @if (technician.availability) {
                  <span class="badge badge-available">
                    <span class="pulse-dot"></span>
                    متاح الآن
                  </span>
                }
                @if (technician.emergencyService) {
                  <span class="badge badge-emergency">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M12 2L1 21H23L12 2Z" fill="currentColor"/>
                    </svg>
                    طوارئ 24/7
                  </span>
                }
              </div>

              <!-- Rating Badge -->
              <div class="rating-badge">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                  <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z" fill="currentColor"/>
                </svg>
                <span>{{ technician.rating }}</span>
              </div>
            </div>

            <!-- Card Body -->
            <div class="card-body">
              <!-- Name & Location -->
              <div class="carpenter-header">
                <h3 class="carpenter-name">{{ technician.name }}</h3>
                <p class="carpenter-location">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z" fill="currentColor"/>
                  </svg>
                  {{ technician.city }}, {{ technician.governorate }}
                </p>
              </div>

              <!-- Specialization Badge -->
              <div class="specialization-tag ac-spec"><svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M6.59 3.41L2 8L3.41 9.41L6.59 6.23C7.97 4.86 10.03 4 12 4C14.76 4 17.07 5.81 17.76 8.26L19.86 7.83C18.92 4.5 15.76 2 12 2C9.34 2 6.95 3.16 5.34 5.02L3.41 3.09L2 4.5L6.59 9.09L11.17 4.5L9.76 3.09L6.59 3.41Z" fill="currentColor"/>
            </svg>
            {{ technician.specialization }}
          </div>

          <!-- Bio -->
          @if (technician.bio) {
            <p class="carpenter-bio">{{ technician.bio }}</p>
          }

          <!-- Info Grid -->
          <div class="info-grid">
            <div class="info-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M20 6H16V4C16 2.89 15.11 2 14 2H10C8.89 2 8 2.89 8 4V6H4C2.89 6 2.01 6.89 2.01 8L2 19C2 20.11 2.89 21 4 21H20C21.11 21 22 20.11 22 19V8C22 6.89 21.11 6 20 6Z" fill="currentColor"/>
              </svg>
              <div class="info-content">
                <span class="info-label">الخبرة</span>
                <span class="info-value">{{ technician.experience }} سنوات</span>
              </div>
            </div>

            @if (technician.minPrice && technician.maxPrice) {
              <div class="info-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M11.8 10.9C9.53 10.31 8.8 9.7 8.8 8.75C8.8 7.66 9.81 6.9 11.5 6.9C13.28 6.9 13.94 7.75 14 9H16.21C16.14 7.28 15.09 5.7 13 5.19V3H10V5.16C8.06 5.58 6.5 6.84 6.5 8.77C6.5 11.08 8.41 12.23 11.2 12.9C13.7 13.5 14.2 14.38 14.2 15.31C14.2 16 13.71 17.1 11.5 17.1C9.44 17.1 8.63 16.18 8.52 15H6.32C6.44 17.19 8.08 18.42 10 18.83V21H13V18.85C14.95 18.48 16.5 17.35 16.5 15.3C16.5 12.46 14.07 11.49 11.8 10.9Z" fill="currentColor"/>
                </svg>
                <div class="info-content">
                  <span class="info-label">السعر</span>
                  <span class="info-value">{{ technician.minPrice }} - {{ technician.maxPrice }} جنيه</span>
                </div>
              </div>
            }
          </div>

          <!-- Brands -->
          @if (technician.brands && technician.brands.length > 0) {
            <div class="services-section">
              <p class="services-title">الماركات المدعومة</p>
              <div class="services-tags">
                @for (brand of technician.brands.slice(0, 5); track brand) {
                  <span class="service-tag ac-brand-tag">{{ brand }}</span>
                }
                @if (technician.brands.length > 5) {
                  <span class="service-tag more-tag">+{{ technician.brands.length - 5 }}</span>
                }
              </div>
            </div>
          }

          <!-- Services -->
          @if (technician.services && technician.services.length > 0) {
            <div class="services-section">
              <p class="services-title">الخدمات المتاحة</p>
              <div class="services-tags">
                @for (service of technician.services.slice(0, 4); track service) {
                  <span class="service-tag ac-service-tag">{{ service }}</span>
                }
                @if (technician.services.length > 4) {
                  <span class="service-tag more-tag">+{{ technician.services.length - 4 }}</span>
                }
              </div>
            </div>
          }

          <!-- Contact Info -->
          <div class="contact-preview">
            <div class="contact-item">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M6.62 10.79C8.06 13.62 10.38 15.94 13.21 17.38L15.41 15.18C15.69 14.9 16.08 14.82 16.43 14.93C17.55 15.3 18.75 15.5 20 15.5C20.55 15.5 21 15.95 21 16.5V20C21 20.55 20.55 21 20 21C10.61 21 3 13.39 3 4C3 3.45 3.45 3 4 3H7.5C8.05 3 8.5 3.45 8.5 4C8.5 5.25 8.7 6.45 9.07 7.57C9.18 7.92 9.1 8.31 8.82 8.59L6.62 10.79Z" fill="currentColor"/>
              </svg>
              <span>{{ technician.phone }}</span>
            </div>
            <div class="contact-item">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M20 4H4C2.9 4 2.01 4.9 2.01 6L2 18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z" fill="currentColor"/>
              </svg>
              <span class="email-text">{{ technician.email }}</span>
            </div>
          </div>
        </div>

        <!-- Card Footer with Actions -->
        <div class="card-footer">
          <button class="btn btn-primary ac-btn-primary" (click)="contactAcTechnician(technician)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M6.62 10.79C8.06 13.62 10.38 15.94 13.21 17.38L15.41 15.18C15.69 14.9 16.08 14.82 16.43 14.93C17.55 15.3 18.75 15.5 20 15.5C20.55 15.5 21 15.95 21 16.5V20C21 20.55 20.55 21 20 21C10.61 21 3 13.39 3 4C3 3.45 3.45 3 4 3H7.5C8.05 3 8.5 3.45 8.5 4C8.5 5.25 8.7 6.45 9.07 7.57C9.18 7.92 9.1 8.31 8.82 8.59L6.62 10.79Z" fill="currentColor"/>
            </svg>
            اتصل الآن
          </button>
          <a [routerLink]="['/ac-technician', technician.id]" class="btn btn-secondary ac-btn-secondary">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5C17 19.5 21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z" fill="currentColor"/>
            </svg>
            عرض الملف
          </a>
        </div>
      </div>
    } @empty {
      <div class="empty-state">
        <div class="empty-illustration">
          <svg width="120" height="120" viewBox="0 0 24 24" fill="none">
            <path d="M6.59 3.41L2 8L3.41 9.41L6.59 6.23C7.97 4.86 10.03 4 12 4C14.76 4 17.07 5.81 17.76 8.26L19.86 7.83C18.92 4.5 15.76 2 12 2C9.34 2 6.95 3.16 5.34 5.02L3.41 3.09L2 4.5L6.59 9.09L11.17 4.5L9.76 3.09L6.59 3.41Z" fill="currentColor" opacity="0.2"/>
          </svg>
        </div>
        <h3 class="empty-title">لا توجد نتائج</h3>
        <p class="empty-text">لم نتمكن من العثور على فنيي تكييف يطابقون بحثك</p>
        <button class="btn btn-primary ac-btn-primary" (click)="searchQuery.set('')">
          مسح البحث
        </button>
      </div>
    }
  </div>
}